# âœ… Phase 1 ì™„ë£Œ - ë°ì´í„°ë² ì´ìŠ¤ í™•ì¥

## ğŸ¯ ì™„ë£Œëœ ì‘ì—…

Phase 1ì—ì„œ í´ë¦¬ë§ˆì¼“ êµ¬ì¡°ë¥¼ ìœ„í•œ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ê³¼ í•¨ìˆ˜ë“¤ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤.

---

## ğŸ“¦ ìƒì„±ëœ íŒŒì¼ ëª©ë¡

### **ì‹ ê·œ ìƒì„± (í´ë¦¬ë§ˆì¼“)**
1. âœ… `01_create_market_categories_table.sql` - ë§ˆì¼“ ì¹´í…Œê³ ë¦¬ (ì •ì¹˜/ê²½ì œ/ì—°ì˜ˆ/ìŠ¤í¬ì¸ )
2. âœ… `02_create_markets_table.sql` - í†µí•© ë§ˆì¼“ í…Œì´ë¸” (ìŠ¤í¬ì¸  + ì¼ë°˜)
3. âœ… `03_create_user_points_table.sql` - ì‚¬ìš©ì í¬ì¸íŠ¸ ê´€ë¦¬
4. âœ… `04_create_point_transactions_table.sql` - í¬ì¸íŠ¸ íŠ¸ëœì­ì…˜
5. âœ… `05_modify_predictions_table.sql` - ì˜ˆì¸¡ í…Œì´ë¸” ì¬êµ¬ì„±
6. âœ… `06_create_helper_functions.sql` - í—¬í¼ í•¨ìˆ˜ë“¤

### **ê¸°ì¡´ ìœ ì§€ (ìŠ¤í¬ì¸ )**
- âœ… `create_soccer_games_table.sql` - ì¶•êµ¬ ê²½ê¸°
- âœ… `create_soccer_teams_table.sql` - ì¶•êµ¬ íŒ€
- âœ… `create_volleyball_games_table.sql` - ë°°êµ¬ ê²½ê¸°
- âœ… `create_volleyball_teams_table.sql` - ë°°êµ¬ íŒ€
- âœ… ê¸°ì¡´ `games`, `KBO_teams` í…Œì´ë¸” (ì´ë¯¸ Supabaseì— ì¡´ì¬)

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    í´ë¦¬ë§ˆì¼“ êµ¬ì¡°                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    market_categories (ì¹´í…Œê³ ë¦¬)
            â†“
        markets (í†µí•© ë§ˆì¼“)
       â†™          â†˜
  [ìŠ¤í¬ì¸ ]      [ì¼ë°˜]
game_id â†’      creator_id
games/          ì‚¬ìš©ì ìƒì„±
soccer_games/
volleyball_games
            â†“
      predictions (ì˜ˆì¸¡)
            â†“
   point_transactions (íŠ¸ëœì­ì…˜)
            â†“
      user_points (í¬ì¸íŠ¸)
```

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„: Supabaseì—ì„œ ì‹¤í–‰

### **ì‹¤í–‰ ìˆœì„œ (ë§¤ìš° ì¤‘ìš”!)**

Supabase Dashboard â†’ SQL Editorì—ì„œ ë‹¤ìŒ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í•˜ì„¸ìš”:

```bash
1ï¸âƒ£ 01_create_market_categories_table.sql
2ï¸âƒ£ 02_create_markets_table.sql
3ï¸âƒ£ 03_create_user_points_table.sql
4ï¸âƒ£ 04_create_point_transactions_table.sql
5ï¸âƒ£ 05_modify_predictions_table.sql  âš ï¸ ê¸°ì¡´ predictions ì‚­ì œë¨!
6ï¸âƒ£ 06_create_helper_functions.sql
```

### **âš ï¸ ì£¼ì˜ì‚¬í•­**
- 5ë²ˆ íŒŒì¼ì€ ê¸°ì¡´ `predictions` í…Œì´ë¸”ì„ ì‚­ì œí•˜ê³  ì¬ìƒì„±í•©ë‹ˆë‹¤
- ê¸°ì¡´ ì˜ˆì¸¡ ë°ì´í„°ê°€ ìˆë‹¤ë©´ ë¨¼ì € ë°±ì—…í•˜ì„¸ìš”!
- ê°œë°œ í™˜ê²½ì—ì„œ ë¨¼ì € í…ŒìŠ¤íŠ¸ í›„ í”„ë¡œë•ì…˜ì— ì ìš©í•˜ì„¸ìš”

---

## ğŸ“Š ì£¼ìš” ê¸°ëŠ¥

### **1. ë§ˆì¼“ ì‹œìŠ¤í…œ**
- âœ… ìŠ¤í¬ì¸  ë§ˆì¼“ (ê¸°ì¡´ ê²½ê¸° ì—°ë™)
- âœ… ì¼ë°˜ ë§ˆì¼“ (ì‚¬ìš©ì ìƒì„±)
- âœ… Yes/No íˆ¬í‘œ
- âœ… ì°¸ì—¬ í†µê³„ (ì°¸ì—¬ì ìˆ˜, í¬ì¸íŠ¸ í’€, Yes/No ë¹„ìœ¨)

### **2. í¬ì¸íŠ¸ ì‹œìŠ¤í…œ**
- âœ… ë³´ìœ /ì‚¬ìš©ê°€ëŠ¥/ì ê¸´ í¬ì¸íŠ¸ ê´€ë¦¬
- âœ… íŠ¸ëœì­ì…˜ ë‚´ì—­ ì¶”ì 
- âœ… ì¶œì„ ì²´í¬ (ì¼ì¼ ë³´ìƒ + ì—°ì† ë³´ë„ˆìŠ¤)
- âœ… ê´‘ê³  ì‹œì²­ ë³´ìƒ (ì¼ì¼ 10íšŒ ì œí•œ)
- âœ… ì¹œêµ¬ ì´ˆëŒ€ ë³´ìƒ

### **3. ì˜ˆì¸¡ ì‹œìŠ¤í…œ**
- âœ… ë§ˆì¼“ë³„ ì˜ˆì¸¡ ì°¸ì—¬
- âœ… ìë™ ì •ì‚° (ê²°ê³¼ í™•ì • í›„)
- âœ… ë³´ìƒ ê³„ì‚° (ì •ë‹µìê°€ í¬ì¸íŠ¸ í’€ì˜ 90% ë¶„ë°°)
- âœ… ìŠ¹ë¥ /ì—°ì† ì •ë‹µ í†µê³„

### **4. ê²Œì´ë¯¸í”¼ì¼€ì´ì…˜**
- âœ… ë ˆë²¨/ê²½í—˜ì¹˜ ì‹œìŠ¤í…œ (ìë™ ë ˆë²¨ì—…)
- âœ… í‹°ì–´ ì‹œìŠ¤í…œ (Bronze â†’ Diamond)
- âœ… ì—°ì† ì •ë‹µ ì¶”ì 
- âœ… ë¦¬ë”ë³´ë“œ (í¬ì¸íŠ¸/ìŠ¹ë¥ /ì—°ì† ì •ë‹µ)

---

## ğŸ”§ ì£¼ìš” í•¨ìˆ˜

### **ì‚¬ìš©ì ê´€ë ¨**
```sql
-- ì‹ ê·œ íšŒì› ì´ˆê¸°í™”
SELECT initialize_user_points('user-uuid', 'ì¶”ì²œì½”ë“œ');

-- ì¼ì¼ ì¶œì„
SELECT check_daily_login('user-uuid');

-- ê´‘ê³  ë³´ìƒ
SELECT reward_ad_view('user-uuid', 'video');

-- í†µê³„ ì¡°íšŒ
SELECT get_user_statistics('user-uuid');
```

### **ë§ˆì¼“ ê´€ë ¨**
```sql
-- í™œì„± ë§ˆì¼“ ì¡°íšŒ
SELECT * FROM get_active_markets('sports', 20, 0);

-- ë§ˆì¼“ í†µê³„
SELECT get_market_statistics('market-uuid');

-- ìë™ ë§ˆê°
SELECT auto_close_expired_markets();
```

### **ì˜ˆì¸¡ ê´€ë ¨**
```sql
-- ì‚¬ìš©ì ì˜ˆì¸¡ ì¡°íšŒ
SELECT * FROM get_user_predictions('user-uuid', 'pending', 20, 0);

-- ì˜ˆì¸¡ ì •ì‚°
SELECT settle_prediction('prediction-uuid');
SELECT settle_market_predictions('market-uuid');
```

### **ë¦¬ë”ë³´ë“œ**
```sql
SELECT * FROM get_leaderboard('points', 100);    -- í¬ì¸íŠ¸ ìˆœìœ„
SELECT * FROM get_leaderboard('win_rate', 100);  -- ìŠ¹ë¥  ìˆœìœ„
SELECT * FROM get_leaderboard('streak', 100);    -- ì—°ì† ì •ë‹µ ìˆœìœ„
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ë°©ë²•

### **1. ê¸°ë³¸ í…ŒìŠ¤íŠ¸**
```sql
-- ì¹´í…Œê³ ë¦¬ í™•ì¸
SELECT * FROM market_categories;

-- í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì ìƒì„±
SELECT initialize_user_points('test-user-id', NULL);

-- í¬ì¸íŠ¸ í™•ì¸
SELECT * FROM user_points WHERE user_id = 'test-user-id';
```

### **2. ë§ˆì¼“ ìƒì„± í…ŒìŠ¤íŠ¸**
```sql
INSERT INTO markets (
    market_type, title, category_slug,
    option_yes, option_no, closes_at, status
) VALUES (
    'general', 'í…ŒìŠ¤íŠ¸ ë§ˆì¼“', 'tech',
    'Yes', 'No', '2025-12-31 23:59:59+09', 'approved'
);
```

### **3. ì˜ˆì¸¡ ì°¸ì—¬ í…ŒìŠ¤íŠ¸**
```sql
INSERT INTO predictions (
    user_id, market_id, predicted_option, points_spent
) VALUES (
    'test-user-id',
    (SELECT id FROM markets WHERE title = 'í…ŒìŠ¤íŠ¸ ë§ˆì¼“'),
    'yes', 50
);
```

---

## ğŸ“ˆ ë‹¤ìŒ Phase ë¯¸ë¦¬ë³´ê¸°

### **Phase 2: ìŠ¤í¬ì¸  ë§ˆì¼“ ìë™í™” (1ì¼)**
- Edge Function: ê²½ê¸° â†’ ë§ˆì¼“ ìë™ ìƒì„±
- ê²½ê¸° ê²°ê³¼ â†’ ë§ˆì¼“ ê²°ê³¼ ìë™ ë°˜ì˜
- ìŠ¤ì¼€ì¤„ëŸ¬ ì„¤ì • (ë§¤ì¼ ìë™ ì‹¤í–‰)

### **Phase 3: ì¼ë°˜ ë§ˆì¼“ UI (2-3ì¼)**
- ì¹´í…Œê³ ë¦¬ íƒ­ ì»´í¬ë„ŒíŠ¸
- ë§ˆì¼“ ë¦¬ìŠ¤íŠ¸/ìƒì„¸ í˜ì´ì§€
- Yes/No íˆ¬í‘œ UI
- ë§ˆì¼“ ìƒì„± í¼

### **Phase 4: í¬ì¸íŠ¸ ì‹œìŠ¤í…œ UI (2ì¼)**
- í¬ì¸íŠ¸ ëŒ€ì‹œë³´ë“œ
- ì¶œì„ ì²´í¬ ëª¨ë‹¬
- ë¦¬ë”ë³´ë“œ í˜ì´ì§€
- ë¦¬ì›Œë“œ ìƒì 

---

## âœ… ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

Phase 1 ì™„ë£Œë¥¼ ìœ„í•´ ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

- [ ] ëª¨ë“  SQL íŒŒì¼ Supabaseì—ì„œ ì‹¤í–‰ ì™„ë£Œ
- [ ] ì—ëŸ¬ ì—†ì´ í…Œì´ë¸” ìƒì„± ì™„ë£Œ
- [ ] ê¸°ë³¸ í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] RLS ì •ì±… ì„¤ì • ì™„ë£Œ
- [ ] ê¸°ì¡´ ìŠ¤í¬ì¸  í…Œì´ë¸” ì •ìƒ ì‘ë™ í™•ì¸

**ëª¨ë‘ ì™„ë£Œë˜ë©´ Phase 2ë¡œ ì§„í–‰í•˜ì„¸ìš”!** ğŸ‰

